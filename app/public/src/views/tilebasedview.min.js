PivotViewer.Views.TileBasedView=PivotViewer.Views.IPivotViewerView.subClass({init:function(){this._super();var t=this;$.subscribe("/PivotViewer/Views/Canvas/Drag",function(e){if(t.isActive){var i=e.x,r=e.y;i>0&&t.currentOffsetX>t.offsetX?i=0:t.currentOffsetX<t.offsetX&&t.currentWidth==t.width?i=0:i<0&&t.currentOffsetX<-t.currentWidth+t.width?i=0:t.currentOffsetX+=i,r>0&&t.currentOffsetY+t.canvasHeightUIAdjusted>t.currentHeight+t.offsetY?r=0:t.currentOffsetY<t.offsetY&&t.currentHeight==t.height?r=0:r<0&&t.currentOffsetY-t.offsetY<-t.currentHeight+t.height?r=0:t.currentOffsetY+=r,0==i&&0==r||t.offsetTiles(i,r)}})},_findFilteredItem:function(t){var e=-1;if("init"==t.type){for(i=0;i<this.filterList.length;i++)if((r=this.filterList[i].item.id)==t.id){e=i;break}}else for(var i=0;i<this.filterList.length;i++){var r=this.filterList[i].contains(t.x,t.y);if(r>=0){e=i;break}}return e},super_handleClick:function(t){var e=this._findFilteredItem(t);return e<0?null:this.filterList[e]},handleClick:function(t){return this.super_handleClick(t)},super_handleDoubleClick:function(t){var e=this._findFilteredItem(t);return e<0?null:this.filterList[e]},handleDoubleClick:function(t){return this.super_handleClick(t)},super_handleHover:function(t){if(null==this.selected)for(var e=0;e<this.filterList.length;e++)this.filterList[e].contains(t.x,t.y)>=0?this.filterList[e].setSelected(!0):this.filterList[e].setSelected(!1)},handleHover:function(t){this.super_handleHover(t)},activate:function(){this._super(),$(".pv-toolbarpanel-zoomslider").fadeIn(),$(".pv-toolbarpanel-zoomcontrols").css("border-width","1px"),$(".pv-toolbarpanel-zoomcontrols").show(),$("#MAIN_BODY").css("overflow","auto"),$(".pv-toolbarpanel-sort").fadeIn(),$(".pv-canvas").fadeIn()},deactivate:function(){this._super(),$(".pv-toolbarpanel-zoomslider").fadeOut(),$(".pv-toolbarpanel-sort").fadeOut(),$(".pv-canvas").fadeOut()},offsetTiles:function(t,e){for(var i=0;i<this.filterList.length;i++)for(var r=this.filterList[i]._locations,s=0;s<r.length;s++)r[s].destinationx+=t,r[s].destinationy+=e},calculateDimensions:function(t,e,i,r){var s=i*(r-.81),n=.9*(e+t*i),o=e*t*-1,l=(-1*n+Math.sqrt(n*n-4*s*o))/(2*s),f=Math.floor(l*i),a=Math.floor(e/f),h=t>l?Math.floor(t/l):1,u=t-h*l,c=e-a*f;return f<3&&(f=3),{Rows:a,Columns:h,TileMaxWidth:l,TileHeight:f,PaddingX:u,PaddingY:c}},getTileDimensions:function(t,e,i,r,s){var n=i*(r-.81),o=.9*(e+t*i),l=e*t*-1,f=(-1*o+Math.sqrt(o*o-4*n*l))/(2*n),a=Math.floor(f*i),h=t-s.Columns*f,u=e-s.Rows*a;return{Rows:s.Rows,Columns:s.Columns,TileMaxWidth:f,TileHeight:a,PaddingX:h,PaddingY:u}}});