PivotViewer.Utils.loadScript("lib/wicket/wicket.min.js"),PivotViewer.Utils.loadCSS("lib/leaflet/leaflet.css"),PivotViewer.Utils.loadScript("lib/leaflet/leaflet.js");var markercluster_ok=!0;PivotViewer.Utils.loadScript("lib/oms.min.js"),markercluster_ok&&PivotViewer.Utils.loadScript("lib/markercluster/markerclusterer.min.js"),PivotViewer.Views.MapView=PivotViewer.Views.IPivotViewerView.subClass({init:function(){this._super(),this.locCache=[],this.map=null,this.markers=[],this.overlay,this.overlayBaseImageUrl=null,this.itemsToGeocode=[],this.startGeocode,this.geocodeZero,this.applyBookmark=!1,this.mapService=null,this.APIKey=null,this.geocodeService=null,this.geometryValue=null,this.areaValues=[],this.areaObj,this.buckets=[],this.icons=[],this.iconsSelected=[],this.selectedMarker=null,this.selectedBucket=-1;var e=this;$.subscribe("/PivotViewer/Views/Item/Selected",function(t){e.isActive&&e.selectMarker(t.item)})},setup:function(e,t,i,a,s){this.width=e,this.height=t,this.offsetX=i,this.offsetY=a,this.currentWidth=this.width,this.currentHeight=this.height,this.currentOffsetX=this.offsetX,this.currentOffsetY=this.offsetY,Modernizr.localstorage?this.localStorage=!0:this.localStorage=!1,window.mapView=this},apiLoaded:function(){var e=this,t={scrollwheel:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],gestureHandling:"greedy"};if(this.map=new google.maps.Map(document.getElementById("pv-map-canvas"),t),this.oms=new OverlappingMarkerSpiderfier(this.map,{markersWontMove:!0,markersWontHide:!0,keepSpiderfied:!0,circleSpiralSwitchover:20}),markercluster_ok&&(this.markerCluster=new MarkerClusterer(this.map,[],{imagePath:"lib/markercluster/images/m",minimumClusterSize:2,maxZoom:17})),google.maps.event.addListener(this.map,"zoom_changed",function(){$.publish("/PivotViewer/Views/Item/Updated",null),e.getOverlay()}),google.maps.event.addListener(this.map,"center_changed",function(){$.publish("/PivotViewer/Views/Item/Updated",null),e.getOverlay()}),void 0!=options.map_icons){var i=options.map_icons.path;if(void 0==i&&(i=""),void 0!=options.map_icons.icons){this.icons=[],this.iconsSelected=[];for(o=0;o<options.map_icons.icons.length;o++){var a=i+options.map_icons.icons[o];this.icons.push(a),this.iconsSelected.push(a)}}if(void 0!=options.map_icons.icons_selected){var s=options.map_icons.icons_selected;this.iconsSelected=[];for(var o=0;o<s.length;o++)this.iconsSelected.push(i+s[o])}}else this.iconsSelected=this.icons=["lib/markercluster/images/photo1.png","lib/markercluster/images/photo2.png","lib/markercluster/images/photo3.png","lib/markercluster/images/photo4.png","lib/markercluster/images/photo5.png","lib/markercluster/images/photo6.png","lib/markercluster/images/photo7.png","lib/markercluster/images/photo8.png","lib/markercluster/images/photo9.png","lib/markercluster/images/photo10.png"];this.clearMarkers=function(){for(var e=0;e<this.tiles.length;e++){var t=this.tiles[e].marker;void 0!=t&&t.setMap(null)}this.markers=[],this.oms.clearMarkers()},this.selectMarker=function(t){var i=e.getBucketNumber(t);if(t.marker==e.selectedMarker)t.marker.setIcon(e.icons[i]),e.selected=null,e.selectedMarker.setZIndex(0),e.selectedMarker=null,e.selectedBucket=-1,$(".pv-toolbarpanel-info").empty(),$(".pv-altinfopanel").fadeIn();else{i instanceof Array&&(i=i[0]),t.marker.setIcon(e.iconsSelected[i]),t.marker.setZIndex(1e9),e.selected=t,null!=e.selectedMarker&&(e.selectedMarker.setZIndex(0),e.selectedMarker.setIcon(e.icons[e.selectedBucket])),e.selectedMarker=t.marker,e.selectedBucket=i,e.map.panTo(t.loc),$(".pv-toolbarpanel-info").empty();var a="<img style='height:15px;width:auto' src='"+e.icons[i]+"'></img>";e.buckets[i].startRange==e.buckets[i].endRange?a+=e.buckets[i].startRange:a+=e.buckets[i].startRange+" to "+e.buckets[i].endRange,$(".pv-toolbarpanel-info").append(a),$(".pv-altinfopanel").hide()}},this.message="Click for info",this.message+="\nDouble click to view ",this.newMarker=function(e){e.marker=new google.maps.Marker({position:e.loc,map:this.map,tile:e,title:this.message}),e.marker.setIcon(this.icons[this.buckets.ids[e.item.id]]);var t=null;google.maps.event.addListener(e.marker,"click",function(e){return function(){null!=t&&clearTimeout(t),t=setTimeout(function(){t=null,$.publish("/PivotViewer/Views/Item/Selected",[{item:e}])},250)}}(e)),google.maps.event.addListener(e.marker,"dblclick",function(e,i,a){return function(){clearTimeout(t),t=null;for(var s=a.markersNearAnyOtherMarker(),o=[],r=0;r<i.length;r++)o.push(i[r].tile.item);for(var n=[],r=0;r<s.length;r++)n.push(s[r].tile.item);$.publish("/PivotViewer/Views/Item/PopViewer",[{item:e,all:o,near:n}])}}(e,this.markers,this.oms)),this.markers.push(e.marker),this.oms.addMarker(e.marker)},this.refitBounds=function(){var e=new google.maps.LatLngBounds;for(o=0;o<this.filterList.length;o++){var t=this.filterList[o];void 0==t.loc||!Settings.showMissing&&t.missing||e.extend(t.marker.position)}this.map.fitBounds(e)},this.getOverlay=function(){if(null!=this.overlayBaseImageUrl){var e=this.map.getBounds();if(e){var t=e.getSouthWest(),i=e.getNorthEast(),a=$("#pv-map-canvas").width(),s=$("#pv-map-canvas").height();this.overlay&&this.overlay.setMap(null);var o=this.overlayBaseImageUrl+"&bbox="+t.lng()+","+t.lat()+","+i.lng()+","+i.lat()+"&width="+a+"&height="+s;this.overlay=new google.maps.GroundOverlay(o,e,{opacity:.4}),this.overlay.setMap(this.map)}}},$(".pv-mainpanel").append("<div class='pv-altinfopanel' id='pv-altinfopanel'></div>"),$(".pv-altinfopanel").css("left",$(".pv-mainpanel").offset().left+$(".pv-mainpanel").width()-205+"px").css("height",$(window).height()-$(".pv-toolbarpanel").height()-58+"px"),this.activate()},setOptions:function(e){if($(".pv-viewpanel").append("<div class='pv-mapview-canvas' id='pv-map-canvas'></div>"),void 0==e.MapService||"openstreetmap"!=e.MapService.toLowerCase())this.APIKey=void 0!=e.GoogleAPIKey?e.GoogleAPIKey:"AIzaSyAnPWLPKMYKQZa2g1p11d_vllwwT7CFdQg",this.mapService="google",PivotViewer.Utils.loadScript("lib/wicket/wicket-gmap3.min.js"),"Google"==e.GeocodeService?this.geocodeService="Google":GeocodeService="Nominatim";else{this.mapService="openstreetmap",this.geocodeService="Nominatim",PivotViewer.Utils.loadScript("lib/wicket/wicket-leaflet.min.js"),this.map=new L.Map(document.getElementById("pv-map-canvas"));this.osm=new L.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Map data Â© OpenStreetMap contributors"}),this.map.addLayer(this.osm),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Red.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Yellow.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/DarkGreen.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Blue.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Purple.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Orange.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Pink.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Sky.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Lime.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Gold.png"}})),this.icons.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/Green.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/RedDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/YellowDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/DarkGreenDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/BlueDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/PurpleDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/OrangeDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/PinkDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/SkyDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/LimeDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/GoldDot.png"}})),this.iconsSelected.push(L.Icon.Default.extend({options:{iconUrl:"lib/leaflet/images/GreenDot.png"}}));var t=this;this.map.on("zoomend",function(e){$.publish("/PivotViewer/Views/Item/Updated",null),t.getOverlay()}),this.map.on("moveend",function(e){$.publish("/PivotViewer/Views/Item/Updated",null),t.getOverlay()}),this.clearMarkers=function(){for(var e=0;e<this.tiles.length;e++){var t=this.tiles[e].marker;void 0!=t&&this.map.removeLayer(t)}this.markers=[],this.oms.clearMarkers()},this.selectMarker=function(e){var i=t.getBucketNumber(e);if(e.marker==t.selectedMarker)e.marker.setIcon(new t.icons[i]),t.selected=null,t.selectedMarker.setZIndexOffset(0),t.selectedMarker=null,t.selectedBucket=-1,$(".pv-toolbarpanel-info").empty(),$(".pv-altinfopanel").fadeIn();else{e.marker.setIcon(new t.iconsSelected[i]),e.marker.setZIndexOffset(1e9),t.selected=e,null!=t.selectedMarker&&(t.selectedMarker.setIcon(new t.icons[t.selectedBucket]),t.selectedMarker.setZIndexOffset(0)),t.selectedMarker=e.marker,t.selectedBucket=i,t.map.panTo(e.loc),$(".pv-toolbarpanel-info").empty();var a="<img style='height:15px;width:auto' src='"+e.marker._icon.src+"'></img>";t.buckets[i].startRange==t.buckets[i].endRange?a+=t.buckets[i].startRange:a+=t.buckets[i].startRange+" to "+t.buckets[i].endRange,$(".pv-toolbarpanel-info").append(a),$(".pv-altinfopanel").hide()}},this.newMarker=function(e){return e.marker=new L.Marker(e.loc,{title:e.item.name}),this.map.addLayer(e.marker),e.marker.setIcon(new this.icons[this.buckets.ids[e.item.id]]),e.marker.on("click",function(e){return function(){$.publish("/PivotViewer/Views/Item/Selected",[{item:e}])}}(e)),e.marker},this.refitBounds=function(){var e=[];for(i=0;i<this.filterList.length;i++){var t=this.filterList[i];void 0!=t.marker&&e.push(t.marker.getLatLng())}var a=new L.LatLngBounds(e);this.map.fitBounds(a)},this.getOverlay=function(){var e=this.map.getBounds(),t=e.getWest(),i=e.getEast(),a=e.getNorth(),s=e.getSouth(),o=this.map.getSize(),r=o.x,n=o.y;if(null!=this.overlayBaseImageUrl){this.overlay&&this.map.hasLayer(this.overlay)&&this.map.removeLayer(this.overlay);var l=this.overlayBaseImageUrl+"&bbox="+t+","+s+","+i+","+a+"&width="+r+"&height="+n;this.overlay=new L.imageOverlay(l,e,{opacity:.4}),this.overlay.addTo(this.map)}}}void 0!=e.MapOverlay&&(this.overlayBaseImageUrl=e.MapOverlay)},activate:function(){if(Modernizr.canvas&&("google"==this.mapService&&null==this.map?PivotViewer.Utils.loadScript("https://maps.googleapis.com/maps/api/js?key="+this.APIKey+"&sensor=false&callback=mapView.apiLoaded"):this._super(),$(".pv-toolbarpanel-info").fadeIn(),$(".pv-altinfopanel").fadeIn(),$(".pv-toolbarpanel-zoomcontrols").hide(),$(".pv-toolbarpanel-zoomcontrols").css("border-width","0"),$("#MAIN_BODY").css("overflow","auto"),$(".pv-mapview-canvas").fadeIn(),$(".pv-toolbarpanel-sort").fadeIn(),null!=this.map)){this.refitBounds(),this.markerCluster.repaint();var e=this;setTimeout(function(){e.markerCluster.repaint()},500)}},deactivate:function(){this._super(),$(".pv-altinfopanel").fadeOut(),$(".pv-toolbarpanel-info").fadeOut(),$(".pv-mapview-canvas").fadeOut(),$(".pv-toolbarpanel-sort").fadeOut()},getBucketNumber:function(e){var t=this.buckets.ids[e.item.id];return void 0!=t?t:-1},bucketize:function(e,t,i){var a=PivotCollection.getCategoryByName(i);if(void 0==t[0].item.getFacetByName(i))return[{startRange:"(no info)",endRange:"(no info)",tiles:[t[0]],values:["(no info)"],startLabel:"(no info)",endLabel:"(no info)"}];for(var s=t[0].item.getFacetByName(i).values[0].value,o=t.length-1;o>0&&void 0==t[o].item.getFacetByName(i);o--);var r=t[o].item.getFacetByName(i).values[0].value;return a.isDateTime()?(s=new Date(s),(r=new Date(r)).getFullYear()-s.getFullYear()+s.getFullYear()%10>9?PivotViewer.Utils.getBuckets(t,i,function(e){var t=new Date(e.value).getFullYear();return t-t%10},function(e){var t=new Date(e.value).getFullYear();return t-t%10+"s"}):r.getFullYear()>s.getFullYear()?PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getFullYear()},function(e){return new Date(e.value).getFullYear().toString()}):r.getMonth()>s.getMonth()?PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getMonth()},function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getFullYear()}):r.getDate()>s.getDate()?PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getDate()},function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()}):r.getHours()>s.getHours()?PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getHours()},function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+" "+PivotViewer.Utils.getMeridian(t)}):r.getMinutes()>s.getMinutes()?PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getMinutes()},function(e){var t=new Date(e);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+t.getMinutes()+" "+PivotViewer.Utils.getMeridian(t)}):PivotViewer.Utils.getBuckets(t,i,function(e){return new Date(e.value).getSeconds()},function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+t.getMinutes()+"::"+t.getSeconds()+" "+PivotViewer.Utils.getMeridian(t)})):PivotViewer.Utils.getBuckets(t,i)},filter:function(){var e=0;this.buckets=this.bucketize(this.tiles,this.filterList,this.sortCategory),$(".pv-toolbarpanel-info").empty(),null==this.selected&&$(".pv-altinfopanel").fadeIn();for(s=0;s<PivotCollection.categories.length;s++)if((t=PivotCollection.categories[s]).name.toUpperCase().indexOf("GEOMETRY")>=0){for(j=0;j<this.filterList.length;j++)if(void 0!=(c=this.filterList[j].item.getFacetByName(t.name))){this.geometryValue=c.values[0].value;break}if(j<this.filterList.length)break}for(s=0;s<PivotCollection.categories.length;s++)if((t=PivotCollection.categories[s]).name.toUpperCase().indexOf("AREA")>=0)for(j=0;j<this.filterList.length;j++)if(void 0!=(c=this.filterList[j].item.getFacetByName(t.name))){this.areaValues.push({id:this.filterList[j].item.id,area:c.values[0].value});break}for(var t,i=null,a=null,s=0;s<PivotCollection.categories.length;s++){var o=(t=PivotCollection.categories[s]).name.toLowerCase();if(t.isLocation()){0==t.uiInit&&PV.initUICategory(t);break}if(o.indexOf("latitude")>=0?i=t:o.indexOf("longitude")>=0&&(a=t),null!=i&&null!=a){0==i.uiInit&&PV.initUICategory(i),0==a.uiInit&&PV.initUICategory(a);break}}for(s=0;s<this.filterList.length;s++){var r=this.filterList[s];if((Settings.showMissing||!r.missing)&&void 0==r.loc){var n=null,l=null;if(null!=i&&null!=a){if(n=r.item.getFacetByName(i.name),l=r.item.getFacetByName(a.name),void 0!=n&&void 0!=l){p=n.values[0].value;null!=(u=l.values[0].value)&&null!=p&&("string"==typeof p&&(p=parseFloat(p)),"string"==typeof u&&(u=parseFloat(u)),isNaN(u)||isNaN(p)||(r.loc=new L.LatLng(p,u)))}}else if(null!=t){var c=r.item.getFacetByName(t.name);if(void 0==c)continue;var h=c.values[0].value;if(0==h.toLowerCase().indexOf("point(")){var u=parseFloat(h.substring(6,h.indexOf(" ",6)-6)),p=parseFloat(h.substring(h.indexOf(" ",6)+1,h.indexOf(")")-(h.indexOf(" ")+1)));isNaN(p)||isNaN(u)||(r.loc=new L.LatLng(p,u))}else if(h.indexOf(",")>-1){var p=parseFloat(h.substring(0,h.indexOf(","))),u=parseFloat(h.substring(h.indexOf(",")));if(isNaN(p)||isNaN(u)){if(h.length>1){var d=h.toUpperCase();if(void 0!=this.locCache[d])r.loc=this.locCache[d];else{e<1e3&&(void 0==this.itemsToGeocode[d]&&(this.itemsToGeocode[d]=[],e++),this.itemsToGeocode[d].push(r))}}}else r.loc=new L.LatLng(p,u)}}}}e>0&&this.getLocationsFromNames(),$(".pv-mapview-canvas").css("height",this.height-12+"px"),$(".pv-mapview-canvas").css("width",this.width-415+"px"),this.createMap()},getButtonImage:function(){return"images/MapView.png"},getButtonImageSelected:function(){return"images/MapViewSelected.png"},getViewName:function(){return"Map View"},makeGeocodeCallBack:function(e){var t=this;return function(i){results=i.results,status=i.status;var a=new L.LatLng(0,0);if(status==google.maps.GeocoderStatus.OK){var s=results[0].geometry.location,o=s.lat,r=s.lng;o&&r&&(a=new L.LatLng(o,r))}t.locCache[e]=a,t.localStorage&&localStorage.setItem(e,JSON.stringify(a));for(var n=0;n<t.itemsToGeocode[e].length;n++)t.itemsToGeocode[e][n].loc=a;delete t.itemsToGeocode[e];var l=new Date;(l.getTime()-t.geocodeZero.getTime())/1e3>20?(t.redrawMarkers(),t.startGeocode=new Date):(l.getTime()-t.startGeocode.getTime())/1e3>2&&(t.redrawMarkers(),t.refitBounds(),t.getOverlay(),t.startGeocode=new Date),0==Object.keys(t.itemsToGeocode).length&&t.createMap()}},geocode:function(e,t){var i="http://www.datasciencetoolkit.org/maps/api/geocode/json?sensor=false&address="+encodeURIComponent(e);$.ajax({type:"GET",url:i,dataType:"jsonp",success:function(e){t(e)}})},getLocationsFromNames:function(){for(var e=0;e<Object.keys(this.itemsToGeocode).length;e++){var t=Object.keys(this.itemsToGeocode)[e];this.geocode(t,this.makeGeocodeCallBack(t))}this.startGeocode=new Date,this.startGeocode.setSeconds(this.startGeocode.getSeconds()+2),this.geocodeZero=new Date},createMap:function(){if(null!=this.geometryValue){var e=new Wkt.Wkt;try{e.read(this.geometryValue)}catch(t){try{e.read(this.geometryValue.replace("\n","").replace("\r","").replace("\t",""))}catch(e){"WKTError"===e.name&&Debug.log("Wicket could not understand the WKT string you entered. Check that you have parentheses balanced, and try removing tabs and newline characters.")}}var t=e.toObject(this.map.defaults);if(Wkt.isArray(t))for(var i=0;i<t.length;i++)this.map.addLayer(t[i]);else this.map.addLayer(t)}this.createMarkers(),this.refitBounds(),this.getOverlay(),this.createLegend(),this.markerCluster.repaint();var a=this;setTimeout(function(){a.markerCluster.repaint()},500)},createMarkers:function(){for(markercluster_ok&&this.markerCluster.clearMarkers(),this.clearMarkers(),i=0;i<this.filterList.length;i++){var e=this.filterList[i];void 0==e.loc||!Settings.showMissing&&e.missing||this.newMarker(e)}markercluster_ok&&this.markerCluster.addMarkers(this.markers,!1)},drawArea:function(){var e,t=new Wkt.Wkt;this.areaObj&&this.map.removeLayer(this.areaObj);for(var i=0;i<this.areaValues.length;i++)if(this.areaValues[i].id==this.selected.item.id){e=this.areaValues[i].area;break}if(e){var a=!0;try{t.read(e)}catch(i){try{t.read(e.replace("\n","").replace("\r","").replace("\t",""))}catch(e){"WKTError"===e.name&&(Debug.log("Wicket could not understand the WKT string you entered. Check that you have parentheses balanced, and try removing tabs and newline characters."),a=!1)}}if(a)if(this.areaObj=t.toObject({color:"#990000",fillColor:"#EEFFCC",fillOpacity:.6}),Wkt.isArray(this.areaObj))for(var s=0;s<this.areaObj.length;s++)this.map.addLayer(this.areaObj[s]);else this.map.addLayer(this.areaObj)}},redrawMarkers:function(){this.createMarkers(),this.drawArea()},createLegend:function(){var e=$(".pv-altinfopanel").width()-32;$(".pv-altinfopanel").empty(),$(".pv-altinfopanel").append("<div class='pv-legend-heading' style='height:28px' title='"+this.sortCategory+"'>"+this.sortCategory+"</div>");for(var t="<table id='pv-legend-data' style='color:#484848;'>",i=0;i<this.buckets.length;i++)t+="<tr><td><img src='"+("google"==this.mapService?this.icons[i]:(new this.icons[i]).options.iconUrl)+"'></img></td>",this.buckets[i].startRange==this.buckets[i].endRange?t+="<td><div style='overflow:hidden;white-space:nowrap;width:"+e+"px;text-overflow:ellipsis'>"+this.buckets[i].startLabel+"</div></td></tr>":t+="<td><div style='overflow:hidden;white-space:nowrap;width:"+e+"px;text-overflow:ellipsis'>"+this.buckets[i].startLabel+" to "+this.buckets[i].endLabel+"</div></td></tr>";t+="</table>",$(".pv-altinfopanel").append(t)}});