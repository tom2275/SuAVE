PivotViewer.Views.SimpleImageController=PivotViewer.Views.IImageController.subClass({init:function(){this._items=[],this._collageItems=[],this._baseUrl="",this._collageMaxLevel=0,this._tileSize=256,this._format="",this._ratio=1,this.MaxRatio=1,this._loadedCount=0,this._zooming=!1;var i=this;$.subscribe("/PivotViewer/ImageController/Zoom",function(t){i._zooming=t})},Setup:function(i){this._baseUrl=i;var t=this;$.getJSON(i+"/imagelist.json").done(function(i){for(var e=0;e<i.ImageFiles.length;e++){var s=new Image;s.onload=function(i){for(var e=0;e<t._items.length;e++)t._items[e].Images[0]==this&&(t._items[e].Width=this.width,t._items[e].Height=this.height,t._loadedCount++),t._loadedCount==t._items.length&&$.publish("/PivotViewer/ImageController/Collection/Loaded",null)},s.src=t._baseUrl+"/"+i.ImageFiles[e],t._items.push(new PivotViewer.Views.SimpleImageItem(i.ImageFiles[e],t._baseUrl,s.width,s.height,s))}}).fail(function(i,t,e){$(".pv-loading").remove();var s="Error loading image files<br><br>";s+="URL        : "+this.url+"<br>",s+="Status : "+jqXHR.status+" "+e+"<br>",s+="Details    : "+jqXHR.responseText+"<br>",s+="<br>Pivot Viewer cannot continue until this problem is resolved<br>",$(".pv-wrapper").append('<div id="pv-imageloading-error" class="pv-modal-dialog"><div><a href="#pv-modal-dialog-close" title="Close" class="pv-modal-dialog-close">X</a><h2>HTML5 PivotViewer</h2><p>'+s+"</p></div></div>"),setTimeout(function(){window.open("#pv-imageloading-error","_self")},1e3)})},GetImages:function(i,t,e){if(t>8&&e>8)for(var s=0;this._items.length;s++)if(this._items[s].ImageId==i)return this._items[s].Images;return null},GetWidthForImage:function(i,t){for(var e=0;e<this._items.length;e++)if(this._items[e].ImageId==i)return Math.floor(t/(this._items[e].Height/this._items[e].Width))},GetWidth:function(i){for(var t=0;t<this._items.length;t++)if(this._items[t].ImageId==i)return this._items[t].Width},GetHeight:function(i){for(var t=0;t<this._items.length;t++)if(this._items[t].ImageId==i)return this._items[t].Height},GetRatio:function(i){for(var t=0;t<this._items.length;t++)if(this._items[t].ImageId==i)return this._items[t].Height/this._items[t].Width}}),PivotViewer.Views.SimpleImageItem=Object.subClass({init:function(i,t,e,s,o){this.ImageId=i,this.BasePath=t,this.Images=[o],this.Width=o.width,this.Height=o.height}});