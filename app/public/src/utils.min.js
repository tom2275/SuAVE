function bucketByName(e,t){for(var i=0;i<e.length;i++)if(e[i].hasValue(t))return e[i];return null}function poz(e){var t,i,n;return i=0==e?0:(t=.5*Math.abs(e))>=3?1:t<1?((((((((.000124818987*(n=t*t)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*t*2:(((((((((((((-45255659e-12*(t-=2)+.00015252929)*t-19538132e-12)*t-.000676904986)*t+.001390604284)*t-.00079462082)*t-.002034254874)*t+.006549791214)*t-.010557625006)*t+.011630447319)*t-.009279453341)*t+.005353579108)*t-.002141268741)*t+.000535310849)*t+.999936657524,e>0?.5*(i+1):.5*(1-i)}function ex(e){return e<-BIGX?0:Math.exp(e)}function pochisq(e,t,i){var n,r,a,o,s,l,u,g=(t-1)*(i-1);if(e<=0||g<1)return 1;if(n=.5*e,u=!(1&g),g>1&&(r=ex(-n)),a=u?r:2*poz(-Math.sqrt(e)),g>2){if(e=.5*(g-1),l=u?1:.5,n>BIGX){for(o=u?0:.5723649429247001,s=Math.log(n);l<=e;)a+=ex(s*l-n-(o=Math.log(l)+o)),l+=1;return a}for(o=u?1:.5641895835477563/Math.sqrt(n),s=0;l<=e;)s+=o*=n/l,l+=1;return s*r+a}return a}Debug.log=function(e){window.console&&window.console.log&&"undefined"!=typeof debug&&1==debug&&window.console.log(e)},window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},PivotViewer.Utils.escapeMetaChars=function(e){return e.replace(/\|/gi,"\\|").replace(/\//gi,"\\/").replace(/'/gi,"\\'").replace(/,/gi,"\\,").replace(/:/gi,"\\:").replace(/\(/gi,"\\(").replace(/\)/gi,"\\)").replace(/\+/gi,"\\+").replace(/\+/gi,"\\-").replace(/\+/gi,"\\_").replace(/\+/gi,"\\%").replace(/\./gi,"\\_")},PivotViewer.Utils.htmlSpecialChars=function(e){return jQuery("<div />").text(e).html()},PivotViewer.Utils.now=function(){return Date.now?Date.now():(new Date).getTime()},PivotViewer.Utils.getOrdinalHistogram=function(e){if(!e instanceof Array)return null;for(var t=Math.min.apply(null,e),i=Math.max.apply(null,e),n=i-t+1,r=[],a=0;a<n;a++)r[a]=0;for(a=0;a<e.length;a++)r[e[a]-t]++;return{histogram:r,min:t,max:i}},PivotViewer.Utils.getHistogram=function(e){if(!e instanceof Array)return null;var t=Math.min.apply(null,e),i=Math.max.apply(null,e),n=2*(Math.floor(Math.pow(2*e.length,1/3))+1);n>e.length?n=e.length:n>10&&(n=10);for(var r=1==n?i-t+1:(i-t)/(n-1),a=[],o=0;o<n;o++)a[o]=0;for(o=0;o<e.length;o++)a[Math.floor((e[o]-t)/r)]++;return{histogram:a,min:t,max:i}},function(e){e.widget("suave.modSlider",e.ui.slider,{getValues:function(){return this.options.values},getOptions:function(){return{min:this.options.min,max:this.options.max}},clearValues:function(){this.options.values=[this.options.min,this.options.max],this._refresh()},updateValues:function(e){this.options.values=e,this._refresh()},changeValues:function(e){for(var t=0;t<e.length;t++)e[t]=Math.floor(e[t]/this.options.step)*this.options.step;this.options.values=e,this._refresh()},addValue:function(e){e=Math.floor(e/this.options.step)*this.options.step,this.options.values.push(e),this.options.values.sort(),this._refresh()},removeValue:function(e){this.options.values.splice(e,1),this._refresh()}})}(jQuery),$.fn.bindFirst=function(e){this.on.apply(this,arguments),this.each(function(){var t=$._data(this,"events")[e.split(".")[0]],i=t.pop();t.splice(0,0,i)})},function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Object.subClass=function(i){function n(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var a=new this;e=!1;for(var o in i)a[o]="function"==typeof i[o]&&"function"==typeof r[o]&&t.test(i[o])?function(e,t){return function(){var i=this._super;this._super=r[e];var n=t.apply(this,arguments);return this._super=i,n}}(o,i[o]):i[o];return n.prototype=a,n.constructor=n,n.subClass=arguments.callee,n}}(),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0===this.lastIndexOf(e,0)}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&e>-9007199254740992&&e<9007199254740992&&Math.floor(e)===e});var tileSortBy=function(e,t,i){var n,r=PivotCollection.getCategoryByName(e),a=[];if(void 0!=i)for(var o=0;o<i.length;o++)a[i[o]]=!0;return n=r.isNumber()||r.isOrdinal()?function(t){var i=t.item.getFacetByName(e);return void 0==i?1/0:i.values[0].value}:r.isDateTime()?function(t){var i=t.item.getFacetByName(e);return void 0==i?new Date(864e13):new Date(i.values[0].value)}:function(t){var i=t.item.getFacetByName(e);if(void 0==i)return"ZZZZZZZ";for(var n=i.values,r=0;r<n.Length;r++)if(a[n[r]])return n[r].value.toUpperCase();return n[0].value.toUpperCase()},t=void 0==t?-1:[-1,1][+!!t],function(e,i){return e=n(e),i=n(i),t*((i>e)-(e>i))}};PivotViewer.Utils.getMonthName=function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]},PivotViewer.Utils.getHour=function(e){var t=e.getHours();return 0==t?12:t>12?t-12:t},PivotViewer.Utils.getSeconds=function(e){var t=e.getSeconds();return t<10?"0"+t:t},PivotViewer.Utils.getMinutes=function(e){var t=e.getMinutes();return t<10?"0"+t:t},PivotViewer.Utils.getMeridian=function(e){return e.getHours()>11?"PM":"AM"},PivotViewer.Utils.getTimeValueFn=function(e,t){return t.getFullYear()-e.getFullYear()+e.getFullYear()%10>9?function(e){var t=new Date(e.value).getFullYear();return t-t%10}:t.getFullYear()>e.getFullYear()?function(e){return new Date(e.value).getFullYear()}:t.getMonth()>e.getMonth()?function(e){return new Date(e.value).getMonth()}:t.getDate()>e.getDate()?function(e){return new Date(e.value).getDate()}:t.getHours()>e.getHours()?function(e){return new Date(e.value).getHours()}:t.getMinutes()>e.getMinutes()?function(e){return new Date(e.value).getMinutes()}:function(e){return new Date(e.value).getSeconds()}},PivotViewer.Utils.getTimeLabelFn=function(e,t){return t.getFullYear()-e.getFullYear()+e.getFullYear()%10>9?function(e){var t=new Date(e.value).getFullYear();return t-t%10+"s"}:t.getFullYear()>e.getFullYear()?function(e){return new Date(e.value).getFullYear().toString()}:t.getMonth()>e.getMonth()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getFullYear()}:t.getDate()>e.getDate()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()}:t.getHours()>e.getHours()?function(e){var t=new Date(e).value;return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+" "+PivotViewer.Utils.getMeridian(t)}:t.getMinutes()>e.getMinutes()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+PivotViewer.Utils.getMinutes(t)+" "+PivotViewer.Utils.getMeridian(t)}:function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+PivotViewer.Utils.getMinutes(t)+"::"+PivotViewer.Utils.getSeconds(t)+" "+PivotViewer.Utils.getMeridian(t)}},PivotViewer.Utils.fillBuckets=function(e,t,i,n){if(void 0==n&&(n=function(e){return e.value}),e.ids=[],(i=PivotCollection.getCategoryByName(i)).isNumber()||i.isOrdinal())for(var r=0,a=0;r<t.length&&void 0!=(s=(o=t[r]).item.getFacetByName(i.name));r++)o.missing||(n(s.values[0])>=e[a].endRange&&a<e.length-1&&a++,e[a].addTile(o),e.ids[o.item.id]=a);else for(r=0;r<t.length;r++){var o=t[r],s=o.item.getFacetByName(i.name);if(void 0==s)break;o.missing||(e[a=e.values[n(s.values[0])]].addTile(o),void 0==e.ids[o.item.id]?e.ids[o.item.id]=[a]:e.ids[o.item.id].push(a))}},PivotViewer.Utils.getBuckets=function(e,t,i,n){void 0==i&&(i=function(e){return e.value}),void 0==n&&(n=function(e){return e.toString()});for(d=0;d<PivotViewer.Models.string_filters.length;d++)if(PivotViewer.Models.string_filters[d].facet==t)var r=PivotViewer.Models.string_filters[d].value;for(var a=PivotCollection.getCategoryByName(t),o=a.isMultipleItems,s=new Set(r),l=[],u=i(e[0].item.getFacetByName(t).values[0]),g=e[0],v=g.item.getFacetByName(t),f=_.flatten(_.pluck(v.values,"value")),c=0;c<f.length;c++){var h=u=m=f[c];if(!o||0==s.size||s.has(u)){for(va in v.values){y=v.values[va].label;if(a.isNumber()||a.isOrdinal()?(y=parseFloat(y.replace(/,/g,"").match(/(?:-?\d+\.?\d*)|(?:-?\d*\.?\d+)/)[0]),$.isNumeric(y)&&(y=n(y))):a.isDateTime()&&(y=moment(y,moment.parseFormat(y))._d.toString()),-1!=y.indexOf(u)){h=a.isDateTime()?(M=new Date(y)).toLocaleDateString():v.values[va].label;break}}(w=new PivotViewer.Models.Bucket(u,h)).addTile(g),w.addValue(u),l.push(w)}}for(var d=1,p=0;d<e.length&&void 0!=(v=(g=e[d]).item.getFacetByName(t));d++)if(!g.missing)for(var f=_.flatten(_.pluck(v.values,"value")),c=0;c<f.length;c++){var m=f[c];if(u=m,!o||0==s.size||s.has(u)){for(var w=null,p=0;p<l.length;p++)if(l[p].hasValue(u)){w=l[p];break}if(!w){for(va in v.values){y=v.values[va].label;if(a.isNumber()||a.isOrdinal()?(y=parseFloat(v.values[va].label.replace(/,/g,"").match(/(?:-?\d+\.?\d*)|(?:-?\d*\.?\d+)/)[0]),$.isNumeric(y)&&(y=n(y))):a.isDateTime()&&(y=moment(y,moment.parseFormat(y))._d.toString()),-1!=y.indexOf(u)){if(a.isDateTime()){var M=new Date(y);h=M.toLocaleDateString()}else h=v.values[va].label;break}}w=new PivotViewer.Models.Bucket(u,h),l.push(w)}g.index=d,w.addTile(g),w.addValue(u)}}if(o)for(d=0;d<l.length-1;d++)for(p=d+1;p<l.length;p++)if(l[d].startLabel.localeCompare(l[p].endLabel)>0){var y=l[d];l[d]=l[p],l[p]=y}if(l.length>10){var V=Math.ceil(l.length/10),F=[];F.ids=[];for(var P=0,D=0;P<l.length;P++){var b,U=P%V,w=l[P];0==U?(F[D]=w,b=F[D]):((b=F[D]).endRange=w.endRange,b.endLabel=w.endLabel,Array.prototype.push.apply(b.tiles,w.tiles),Array.prototype.push.apply(b.values,w.values));for(var N in w.ids)b.ids[N]=!0,void 0==F.ids[N]?F.ids[N]=[D]:F.ids[N].push(D);U+1==V&&D++}l=F}else{l.ids=[];for(p=0;p<l.length;p++)for(var N in l[p].ids)void 0==l.ids[N]?l.ids[N]=[p]:l.ids[N].push(p)}if(d!=e.length&&Settings.showMissing){var S=new PivotViewer.Models.Bucket("(no info)","(no info");l.push(S);for(D=l.length-1;d<e.length;d++)S.addTile(e[d]),S.ids[e[d].item.id]=!0,l.ids[e[d].item.id]=D}return l},PivotViewer.Utils.loadScript=function(e){if(0==$("script[src*='"+e+"']").length){var t=document.createElement("script");t.type="text/javascript",t.src=e,$("head").append(t)}},PivotViewer.Utils.loadCSS=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e};var BIGX=20;